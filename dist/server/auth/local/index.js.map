{"version":3,"sources":["auth/local/index.js"],"names":["router","Router","post","req","res","next","authenticate","err","user","info","console","log","error","status","json","message","token","_id","role"],"mappings":"AAAA;;;;;;AAEA;;;;AACA;;;;AACA;;;;AAEA,IAAIA,SAAS,kBAAQC,MAAR,EAAb;;AAEAD,OAAOE,IAAP,CAAY,GAAZ,EAAiB,UAASC,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AACxC,qBAASC,YAAT,CAAsB,OAAtB,EAA+B,UAASC,GAAT,EAAcC,IAAd,EAAoBC,IAApB,EAA0B;AACvDC,YAAQC,GAAR,CAAY,uBAAZ,EAAqCH,IAArC,EAA2CC,IAA3C,EAAiDF,GAAjD;AACA,QAAIK,QAAQL,OAAOE,IAAnB;AACA,QAAGG,KAAH,EAAU;AACR,aAAOR,IAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBF,KAArB,CAAP;AACD;AACD,QAAG,CAACJ,IAAJ,EAAU;AACR,aAAOJ,IAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAACC,SAAS,yCAAV,EAArB,CAAP;AACD;;AAED,QAAIC,QAAQ,qBAAUR,KAAKS,GAAf,EAAoBT,KAAKU,IAAzB,CAAZ;AACAd,QAAIU,IAAJ,CAAS,EAAEE,YAAF,EAAT;AACD,GAZD,EAYGb,GAZH,EAYQC,GAZR,EAYaC,IAZb;AAaD,CAdD;;kBAgBeL,M","file":"index.js","sourcesContent":["'use strict';\n\nimport express from 'express';\nimport passport from 'passport';\nimport {signToken} from '../auth.service';\n\nvar router = express.Router();\n\nrouter.post('/', function(req, res, next) {\n  passport.authenticate('local', function(err, user, info) {\n    console.log('passport.authenticate', user, info, err);\n    var error = err || info;\n    if(error) {\n      return res.status(401).json(error);\n    }\n    if(!user) {\n      return res.status(404).json({message: 'Something went wrong, please try again.'});\n    }\n\n    var token = signToken(user._id, user.role);\n    res.json({ token });\n  })(req, res, next);\n});\n\nexport default router;\n"]}